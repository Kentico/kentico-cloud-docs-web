/**
 * Initializes lightbox and caption if available
 */
(() => {
    setTimeout(() => {
        document.querySelectorAll('.article__content img.article__add-lightbox').forEach(item => {
            let figcaption = '';
            let nextSibling = item.nextSibling;
            let nextNextSibling = nextSibling.nextSibling;

            // Find caption in DOM generated by Kentico Cloud
            let captionElem = (() => {
                if (nextSibling.tagName === 'FIGCAPTION') {
                    return nextSibling;
                } else if (nextNextSibling.tagName === 'FIGCAPTION') {
                    return nextNextSibling;
                } else {
                    return null;
                }
            })();

            if (captionElem !== null) {
                figcaption = `<p>${captionElem.innerHTML}</p>`;
            }
            
            // Init lighbox with caption
            item.addEventListener('click', event => {
                basicLightbox.create(`<img src="${item.getAttribute('src')}">${figcaption}`).show();
            });
        });
    }, 0);
})();
